# SoundScape å£°å¢ƒ - å®Œæ•´éƒ¨ç½²å’Œå¯åŠ¨æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**å£°å¢ƒ SoundScape** æ˜¯ä¸€ä¸ªAIé©±åŠ¨çš„å£°éŸ³å¨±ä¹åº”ç”¨ï¼Œé€šè¿‡æƒ…ç»ªè¯†åˆ«ä¸ºç”¨æˆ·æä¾›ä¸ªæ€§åŒ–çš„å£°éŸ³ä½“éªŒå’Œå†…å®¹æ¨èã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¤ **æƒ…ç»ªè¯†åˆ«**ï¼šè¯­éŸ³/æ–‡æœ¬è¾“å…¥ï¼ŒAIåˆ†ææƒ…ç»ªç±»å‹å’Œå¼ºåº¦
- ğŸ¯ **æ™ºèƒ½æ¨è**ï¼šæ ¹æ®æƒ…ç»ªæ¨è4ç±»åº”ç”¨ï¼ˆç–—æ„ˆ/å‰§åœº/éŸ³ä¹/åŠ©æ‰‹ï¼‰
- ğŸµ **å¤šåœºæ™¯ä½“éªŒ**ï¼šæ‚²ä¼¤â†’ç–—æ„ˆç«™ã€å¹³é™â†’å‰§åœºã€å¿«ä¹â†’å·¥åŠã€ä¸­æ€§â†’åŠ©æ‰‹
- ğŸ’¾ **è®°å¿†ç³»ç»Ÿ**ï¼šè‡ªåŠ¨ä¿å­˜ä¼šè¯ã€ç”Ÿæˆæ€»ç»“ã€æ”¯æŒåˆ†äº«
- ğŸ“Š **æ•°æ®åˆ†æ**ï¼šæƒ…ç»ªè¶‹åŠ¿ã€åº”ç”¨ä½¿ç”¨ç»Ÿè®¡ã€ä¸ªæ€§åŒ–å­¦ä¹ 

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‰ç«¯ (React + Vite)                  â”‚
â”‚  WelcomePage â†’ HomePage â†’ EmotionDetection  â”‚
â”‚         â†’ AppRecommendation â†’ Selected App  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ /api
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Node.js API ç½‘å…³ (3000)                 â”‚
â”‚  /auth, /emotion, /apps, /memory            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ internal
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python FastAPI (8000)    â”‚    â”‚ SQLite DB â”‚
â”‚  /emotion/analyze         â”‚â—„â”€â”€â–ºâ”‚ (æœ¬åœ°)    â”‚
â”‚  /recommend/apps          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  /memory/summarize        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

### å‰ç½®è¦æ±‚

- **Node.js** 16+
- **Python** 3.8+
- **npm** æˆ– **yarn**

### 1ï¸âƒ£ å®‰è£…ä¾èµ–

#### å‰ç«¯
```bash
cd frontend-web
npm install
```

#### Node.js åç«¯
```bash
cd backend-nodejs
npm install
```

#### Python åç«¯
```bash
cd backend-ai
pip install -r requirements.txt
```

### 2ï¸âƒ£ é…ç½®ç¯å¢ƒå˜é‡

#### æ ¹ç›®å½•åˆ›å»º `.env`
```bash
# OpenAI API
OPENAI_API_KEY=your_api_key_here

# æœåŠ¡ç«¯å£
FRONTEND_PORT=5173
NODEJS_PORT=3000
FASTAPI_PORT=8000

# æ•°æ®åº“
DB_PATH=./soundscape.db

# APIåœ°å€
FASTAPI_URL=http://localhost:8000
NODE_API_URL=http://localhost:3000
```

#### `backend-ai/.env.example` â†’ `backend-ai/.env`
```bash
OPENAI_API_KEY=your_api_key_here
DATABASE_URL=sqlite:///soundscape.db
LOG_LEVEL=INFO
```

### 3ï¸âƒ£ åˆå§‹åŒ–æ•°æ®åº“

```bash
cd backend-ai
python init_db.py
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
âœ… æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: soundscape.db
âœ… å·²åˆ›å»ºä»¥ä¸‹è¡¨: users, sessions, emotion_records, dapps, ...
âœ… å·²æ’å…¥ 4 ä¸ªåº”ç”¨
```

### 4ï¸âƒ£ å¯åŠ¨æ‰€æœ‰æœåŠ¡

#### ç»ˆç«¯ 1 - å‰ç«¯å¼€å‘æœåŠ¡å™¨
```bash
cd frontend-web
npm run dev
# è®¿é—®: http://localhost:5173
```

#### ç»ˆç«¯ 2 - Node.js åç«¯
```bash
cd backend-nodejs
npm start
# æˆ–: node src/app.js
# æœåŠ¡: http://localhost:3000
```

#### ç»ˆç«¯ 3 - Python FastAPI åç«¯
```bash
cd backend-ai
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
# æœåŠ¡: http://localhost:8000
# æ–‡æ¡£: http://localhost:8000/docs
```

---

## ğŸ“± åŠŸèƒ½æµç¨‹

### ç”¨æˆ·å…¥å£æµç¨‹

```
1. æ¬¢è¿é¡µ (WelcomePage)
   â†“
   è¾“å…¥æ˜µç§° â†’ æˆæƒéº¦å…‹é£
   â†“
2. ä¸»é¡µ (HomePage)
   â†“
   æ˜¾ç¤º: "__ç”¨æˆ·åï¼Œä»Šå¤©ä¹Ÿå¾ˆæ£’å‹’ï¼"
   â†“
3. æƒ…ç»ªè¯†åˆ« (EmotionDetectionPage)
   â†“
   è¯­éŸ³è¾“å…¥ / æ–‡æœ¬è¾“å…¥
   â†“
4. æƒ…ç»ªåˆ†æ (Python)
   â†“
   è¿”å›: æƒ…ç»ªç±»å‹ + å¼ºåº¦
   â†“
5. åº”ç”¨æ¨è (AppRecommendation)
   â†“
   æ ¹æ®æƒ…ç»ªæ¨è4ä¸ªåº”ç”¨
   â†“
6. åº”ç”¨é€‰æ‹©
   â†“
   è¿›å…¥å¯¹åº”åº”ç”¨ (HealingStation / Theatre / Workshop / Assistant)
```

### å…³é”®ç»„ä»¶è¯´æ˜

| ç»„ä»¶ | åŠŸèƒ½ | è·¯ç”± |
|------|------|------|
| **WelcomePage** | ç”¨æˆ·æ¬¢è¿å’Œç™»å½• | `/welcome` |
| **HomePage** | ä¸»é¡µï¼Œæ˜¾ç¤ºæ‹›å‘¼è¯­ | `/home` |
| **EmotionDetectionPage** | æƒ…ç»ªè¯†åˆ«å…¥å£ | `/emotion-detection` |
| **AudioRecorder** | éŸ³é¢‘å½•åˆ¶ç»„ä»¶ | - |
| **EmotionDisplay** | æƒ…ç»ªå¯è§†åŒ–çƒä½“ | - |
| **AppRecommendation** | åº”ç”¨æ¨èå’Œæœç´¢ | - |
| **DAppCard** | å•ä¸ªåº”ç”¨å¡ç‰‡ | - |

---

## ğŸ”Œ API ç«¯ç‚¹

### è®¤è¯ç›¸å…³
```
POST /api/auth/login
POST /api/auth/register
POST /api/auth/logout
GET  /api/auth/me
```

### æƒ…ç»ªè¯†åˆ«
```
POST /api/emotion/analyze
  è¯·æ±‚: { audio: base64 } æˆ– { text: "..." }
  å“åº”: { emotion_type, intensity, confidence, transcript }

GET  /api/emotion/history?userId=xxx&days=7
GET  /api/emotion/trend?userId=xxx
```

### åº”ç”¨æ¨è
```
POST /api/apps/recommend
  è¯·æ±‚: { emotion_type, emotion_intensity, user_id }
  å“åº”: { recommended_apps: [...] }

GET  /api/apps/search?q=æœç´¢è¯
GET  /api/apps
GET  /api/apps/:appId
POST /api/apps/usage
```

### è®°å¿†ç®¡ç†
```
POST /api/memory/create
GET  /api/memory/list?userId=xxx&limit=50
GET  /api/memory/:memoryId
PUT  /api/memory/:memoryId
DELETE /api/memory/:memoryId
GET  /api/memory/summary?userId=xxx&period=month
POST /api/memory/:memoryId/share
```

---

## ğŸ—„ï¸ æ•°æ®åº“è¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | ä¸»è¦å­—æ®µ |
|------|------|---------|
| **users** | ç”¨æˆ·è¡¨ | id, username, created_at |
| **sessions** | ä¼šè¯è¡¨ | id, user_id, token, created_at |
| **emotion_records** | æƒ…ç»ªè®°å½• | id, user_id, emotion_type, intensity |
| **dapps** | åº”ç”¨è¡¨ | id, name, type, category, entry_point |
| **app_usage** | åº”ç”¨ä½¿ç”¨è®°å½• | id, app_id, user_id, used_at |
| **memories** | è®°å¿†è¡¨ | id, user_id, emotion_type, summary |
| **recommendation_feedback** | æ¨èåé¦ˆ | id, user_id, recommended_app_id |

---

## ğŸ“Š æƒ…ç»ªè¯†åˆ«æ˜ å°„

| æƒ…ç»ªç±»å‹ | æ¨èåº”ç”¨ | ç‰¹ç‚¹ |
|---------|--------|------|
| **sad** (æ‚²ä¼¤) | å£°éŸ³ç–—æ„ˆç«™ | å¼ºåº¦>0.6æ—¶ä¼˜å…ˆæ¨è |
| **calm** (å¹³é™) | å£°éŸ³å‰§åœº | é€‚åˆæ”¾æ¾å’Œå¨±ä¹ |
| **happy** (å¿«ä¹) | AIéŸ³ä¹å·¥åŠ | æœ€é€‚åˆåˆ›æ„è¡¨è¾¾ |
| **neutral** (ä¸­æ€§) | ä¸ªäººå£°éŸ³åŠ©æ‰‹ | é€šç”¨å’Œæ•ˆç‡å¯¼å‘ |

---

## ğŸ¨ UIç»„ä»¶åº“

### æ ·å¼æ–‡ä»¶ä½ç½®
```
frontend-web/src/styles/
â”œâ”€â”€ Global.css           # å…¨å±€æ ·å¼å’Œå“åº”å¼è®¾è®¡
â”œâ”€â”€ WelcomePage.css      # æ¬¢è¿é¡µ
â”œâ”€â”€ HomePage.css         # ä¸»é¡µ
â”œâ”€â”€ EmotionDetectionPage.css  # æƒ…ç»ªè¯†åˆ«é¡µ
â”œâ”€â”€ AudioRecorder.css    # éŸ³é¢‘å½•åˆ¶
â”œâ”€â”€ EmotionDisplay.css   # æƒ…ç»ªå±•ç¤º
â”œâ”€â”€ AppRecommendation.css # åº”ç”¨æ¨è
â””â”€â”€ DAppCard.css         # åº”ç”¨å¡ç‰‡
```

### å“åº”å¼æ–­ç‚¹
- **æ‰‹æœº**: â‰¤480px
- **å¹³æ¿**: 481px-768px
- **æ¡Œé¢**: 769px-1920px
- **KTV**: â‰¥1920px

---

## ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# ç¡®ä¿æ•°æ®åº“å·²åˆå§‹åŒ–
cd backend-ai
python init_db.py
```

### 2. Pythonä¾èµ–ç¼ºå¤±
```bash
cd backend-ai
pip install --upgrade pip
pip install -r requirements.txt
```

### 3. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹å ç”¨æƒ…å†µ
lsof -i :3000
lsof -i :8000
lsof -i :5173

# ä¿®æ”¹ç«¯å£
# frontend-web: vite.config.js
# backend-nodejs: .env NODEJS_PORT
# backend-ai: uvicorn å‘½ä»¤è¡Œå‚æ•°
```

### 4. CORS é”™è¯¯
ç¡®ä¿ `backend-nodejs/app.js` ä¸­ CORS é…ç½®æ­£ç¡®ï¼š
```javascript
app.use(cors({
  origin: ["http://localhost:5173", "http://localhost:3000"],
  methods: ["GET", "POST", "PUT", "DELETE"],
  credentials: true
}));
```

### 5. OpenAI API é”™è¯¯
æ£€æŸ¥ï¼š
- API Key æ˜¯å¦æ­£ç¡®
- è´¦æˆ·ä½™é¢æ˜¯å¦å……è¶³
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

---

## ğŸ“¦ ç”Ÿäº§éƒ¨ç½²ï¼ˆDockerï¼‰

### ä½¿ç”¨ Docker Compose
```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨å®¹å™¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢å®¹å™¨
docker-compose down
```

### Docker Compose é…ç½®
å‚è§: `deployment/docker/docker-compose.yml`

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å‰ç«¯
- âœ… ä½¿ç”¨æ‡’åŠ è½½ç»„ä»¶
- âœ… éŸ³é¢‘æµå¼ä¼ è¾“
- âœ… æœ¬åœ°ç¼“å­˜æƒ…ç»ªæ•°æ®
- âœ… å›¾ç‰‡å’Œèµ„æºCDNåŠ é€Ÿ

### åç«¯
- âœ… ç¼“å­˜ API å“åº”
- âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- âœ… è¿æ¥æ± ç®¡ç†
- âœ… æ—¥å¿—å¼‚æ­¥å¤„ç†

### æ•°æ®åº“
- âœ… å®šæœŸå¤‡ä»½
- âœ… æ¸…ç†è¿‡æœŸæ•°æ®
- âœ… æŸ¥è¯¢ä¼˜åŒ–

---

## ğŸ” å®‰å…¨å»ºè®®

- ğŸ”’ ç¯å¢ƒå˜é‡ç®¡ç†ï¼ˆä¸è¦æäº¤ `.env`ï¼‰
- ğŸ”’ è¾“å…¥éªŒè¯å’ŒXSSé˜²æŠ¤
- ğŸ”’ é€Ÿç‡é™åˆ¶ï¼ˆé˜²DDoSï¼‰
- ğŸ”’ CSRFä»¤ç‰Œä¿æŠ¤
- ğŸ”’ HTTPSéƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

---

## ğŸ“š æ–‡æ¡£å’Œèµ„æº

- **API æ–‡æ¡£**: `docs/API.md`
- **éƒ¨ç½²æŒ‡å—**: `docs/DEPLOYMENT.md`
- **å¼€å‘æŒ‡å—**: `docs/DEVELOPMENT.md`
- **ç”¨æˆ·æŒ‡å—**: `docs/USER_GUIDE.md`

---

## ğŸ¤ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| **å‰ç«¯** | React 18, Vite, React Router |
| **Node.js** | Express.js, SQLite3, Axios |
| **Python** | FastAPI, OpenAI API, Whisper |
| **éƒ¨ç½²** | Docker, Docker Compose, Nginx |
| **æ•°æ®åº“** | SQLite (æœ¬åœ°è½»é‡çº§) |

---

## ğŸ“ æ”¯æŒä¸è´¡çŒ®

æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Ÿæ¬¢è¿æäº¤ Issue æˆ– PRï¼

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼å£°éŸ³æ˜¯ä¸€ç§åŠ›é‡ã€‚ğŸµ**
